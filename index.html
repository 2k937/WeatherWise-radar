<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>WeatherWise Elite</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  #map { height: 100vh; width: 100%; }
  select { position: absolute; top: 10px; left: 10px; z-index: 1000; width: 200px; }
</style>
</head>
<body>

<select id="radarSelect">
  <!-- 160+ radar towers -->
  <option value="KOAX_REF0">KOAX REF0</option>
  <option value="KOAX_VEL0">KOAX VEL0</option>
  <option value="KTLX_REF0">KTLX REF0</option>
  <option value="KTLX_VEL0">KTLX VEL0</option>
  <option value="OAX_REF0">OAX REF0</option>
  <option value="OAX_VEL0">OAX VEL0</option>
  <option value="DMX_REF0">DMX REF0</option>
  <option value="DMX_VEL0">DMX VEL0</option>
  <option value="FSD_REF0">FSD REF0</option>
  <option value="FSD_VEL0">FSD VEL0</option>
  <option value="MPX_REF0">MPX REF0</option>
  <option value="MPX_VEL0">MPX VEL0</option>
  <option value="DVN_REF0">DVN REF0</option>
  <option value="DVN_VEL0">DVN VEL0</option>
  <option value="ARX_REF0">ARX REF0</option>
  <option value="ARX_VEL0">ARX VEL0</option>
  <option value="ILX_REF0">ILX REF0</option>
  <option value="ILX_VEL0">ILX VEL0</option>
  <option value="LSX_REF0">LSX REF0</option>
  <option value="LSX_VEL0">LSX VEL0</option>
  <!-- … all remaining NEXRAD radar sites … total 160+ entries … -->
</select>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('map').setView([39.5, -98.35], 5);

// Mapbox dark base layer
L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
    attribution: '© Mapbox © OpenStreetMap',
    tileSize: 512,
    zoomOffset: -1,
    id: 'mapbox/dark-v11',
    accessToken: 'pk.eyJ1IjoidHdhbGtlcjkyIiwiYSI6ImNtZDkwaHMwdTAyazkya3BzNXphYWI3a2kifQ.sWYO653OYlYHYc_wOHsd2A'
}).addTo(map);

let radarLayer = null;
const select = document.getElementById('radarSelect');

function loadRadar() {
    const val = select.value;
    const url = `/tiles/${val}.png`;

    if (radarLayer) map.removeLayer(radarLayer);
    radarLayer = L.imageOverlay(url, map.getBounds(), {opacity:0.7});
    radarLayer.addTo(map);

    fetch(`/update/${val.split('_')[0]}/${val.split('_')[1]}`);
}

select.addEventListener('change', loadRadar);
loadRadar();
</script>
</body>
</html>
